<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <template id = "mondido_test">
        <form id="mondidopayform" action="https://api.mondido.com/v1/transactions" method="post">
            <label>
            Card holder name
            <input type="text" name="card_holder" value="John Doe"/>
            </label>
            <label>
            Card number
            <input type="text" data-encrypted-attribute="card_number" value="4111111111111111"/>
            </label>
            <label>
            Card type
            <input type="text" name="card_type" value="VISA"/>
            </label>
            <label>
            Card expiry (MMYY)
            <input type="text" name="card_expiry" value="0918"/>
            </label>
            <label>
            CVV
            <input type="text" data-encrypted-attribute="card_cvv" value="200"/>
            </label>
            <label>
            Order ID
            <input type="hidden" name="payment_ref" value="123"/>
            </label>
            <label>
            Amount
            <input type="hidden" name="amount" value="1.00"/>
            </label>
            <label>
            Currency
            <input type="hidden" name="currency" value="sek"/>
            </label>
            <label>
            Hash
            <input type="hidden" name="hash" value=""/>
            </label>
            <label>
            Merchant ID
            <input type="text" name="merchant_id" value="3"/>
            </label>
            <label>
            Store Card
            <input type="text" name="store_card" value="true"/>
            </label>

            <label>
            Webhook
            <input type="text" name="webhook" value='{"url":"https://mybackend.com/confirmOrderFromMondido","trigger":"payment_success","http_method":"post","data_format":"form_data"}'/>
            </label>

            <label>
            Metadata
            <input type="text" name="metadata" value='{"products":[{"id":"1","name":"Nice Shoe","price":"100.00","qty":"1","url":"https://mysite.com/product/1"}],"user":{"email":"jd@email.com"}}'/>
            </label>

            <input type="hidden" name="customer_ref" value="1"/>
            <input type="hidden" name="test" value="true"/>
            <input type="hidden" name="encrypted" value="card_number,card_cvv"/>

            <input type="submit" value="Pay" class="btn"/>
        </form>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="https://blueimp.github.io/JavaScript-MD5/js/md5.js"></script>
        <script src="https://cdn-web01.mondido.com/v2/mondido.js?merchant_id=3"> </script>
        <script src="/Mondido_Payment/static/src/js/mondido_js.js"> </script>
            var onSuccess = function (transaction) {
                if(window.mondido.hasCallback){
                    return;
                }
                alert('Thank you for the payment!');
                window.mondido.hasCallback = true;
            };
            var onError = function (error,data) {
                if(window.mondido.hasCallback){
                    return;
                }
                if (data != null) {
                    alert(data.description);
                }
                window.mondido.hasCallback = true;
            };

            var onBefore = function(){
                window.mondido = {hasCallback: false};
            };

            $('#mondidopayform')
                .mondido({type:"ajax"})
                .on('payment:before', onBefore)
                .on('payment:success', onSuccess)
                .on('payment:fail', onError);

            var payment_ref = Math.floor((Math.random() * 10000) + 1).toString(); //random payment reference
            var secret = "$2a$10$k/wS5qecZLyMmqo0e8GV9."; // ssshhh, this is the secret.
            var merchant_id = "3";
            var customer_ref = "customer1";
            var amount = "1.00";
            var h_str = merchant_id+payment_ref+amount+customer_ref+"sek"+"test"+secret;
            var hash = md5(h_str);

            $('input[name="customer_ref"]').val(customer_ref);
            $('input[name="merchant_id"]').val(merchant_id);
            $('input[name="payment_ref"]').val(payment_ref);
            $('input[name="hash"]').val(hash);
            $('input[name="amount"]').val(amount);

    </template>
</odoo>
<!--        <link-->
<!--                        rel="stylesheet"-->
<!--                        type="text/css"-->
<!--                        href="/Mondido_Payment/static/src/css/mondido_style.css"-->
<!--                    />-->
<!--        <script type="text/javascript" src="/Mondido_Payment/static/src/js/mondido_js.js"/>-->


<!--<div class="container">-->
<!--    <div class="form-signin checkout_payment_option selected mondidojs">-->
<!--        <div class="container-bb">-->
<!--            <div class="row-bb">-->
<!--                <div class="col-lg-8 col-lg-offset-2">-->
<!--                    <form id="mondidopayform">-->
<!--                        <div class="wrp">-->
<!--                            <div id="addCard">-->
<!--                                <div class="panel">-->
<!--                                    <h2>Card Payment, <span class="strong">1 EUR</span></h2>-->
<!--                                    <div class="form-group col-lg-12">-->
<!--                                        <label>Card Holder Name</label>-->
<!--                                        <input type="text" class="form-control" name="card_holder" style="width:100%;" placeholder="Firstname Lastname"/>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="panel">-->
<!--                                    <div class="col-sm-5 form-group">-->
<!--                                        <label>Card Number</label>-->
<!--                                        <input type="text" class="form-control" data-encrypted-attribute="card_number" style="width:100%;" placeholder="4111111111111111"/>-->
<!--                                    </div>-->
<!--                                    <div class="col-sm-3 col-xs-6 form-group third float-left">-->
<!--                                        <label>CVV</label>-->
<!--                                        <input type="text" class="form-control" data-encrypted-attribute="card_cvv" style="width:90%;" placeholder="000"/>-->
<!--                                    </div>-->
<!--                                    <div class="col-sm-2 col-xs-3 form-group third float-left">-->
<!--                                        <label>Month</label>-->
<!--                                        <input type="text" name="expMM" class="form-control" maxlength="2" style="width:90%;" placeholder="01"/>-->
<!--                                    </div>-->
<!--                                    <div class="col-sm-2 col-xs-3 form-group third float-left">-->
<!--                                        <label>Year</label>-->
<!--                                        <input type="text" name="expYY" class="form-control" maxlength="2" style="width:90%;" placeholder="15"/>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="stripes bottom"> </div>-->
<!--                                <div style="margin:10px 0;">-->
<!--                                    <input type="checkbox" name="store_card" value="true"/> Store Card (<span class="storeCardInfo">What is this</span>)-->
<!--                                </div>-->
<!--                                <div class="clear">-->
<!--                                </div>-->

<!--                                <input type="submit" value="Finish Payment" id="btnPay" class="btn_blue fullsize btn-primary mondidocheckout"/>-->
<!--                                <div>-->
<!--                                    <div id="credit-card-list">-->
<!--                                        <img alt="Mastercard" class="card_mastercard card_icon" src="https://raw.githubusercontent.com/Mondido/mondido-js/master/images/mastercard.png"/>-->
<!--                                        <img alt="Visa" class="card_visa card_icon" src="https://raw.githubusercontent.com/Mondido/mondido-js/master/images/visa.png"/>-->
<!--                                        <img alt="Amex"  class="card_amex card_icon" src="https://raw.githubusercontent.com/Mondido/mondido-js/master/images/amex.png"/>-->
<!--                                        <img alt="Discover" class="card_discover card_icon" src="https://raw.githubusercontent.com/Mondido/mondido-js/master/images/discover.png"/>-->
<!--                                        <img alt="Maestro" class="card_maestro  card_icon" src="https://raw.githubusercontent.com/Mondido/mondido-js/master/images/maestro.png"/>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            &lt;!&ndash; order data &ndash;&gt;-->
<!--                            <input type="hidden" data-encrypted-attribute="card_type" value="" />-->
<!--                            <input type="hidden" data-encrypted-attribute="card_expiry" value=""/>-->
<!--                            <input type="hidden" name="amount" value="1.00" />-->
<!--                            <input type="hidden" name="currency" value="EUR" />-->
<!--                            <input type="hidden" name="test" value="true" />-->
<!--                            <input type="hidden" name="metadata" value='{"products":[{"id":"1","name":"Nice Shoe","price":"1.00","qty":"1","url":"https://mysite.com/product/1"}],"user":{"email":"jd@email.com"}}' />-->
<!--                            <input type="hidden" name="merchant_id" value="" />-->
<!--                            <input type="hidden" name="payment_ref" value="" />-->
<!--                            <input type="hidden" name="locale" value="en" />-->
<!--                            <input type="hidden" name="hash" value="" />-->
<!--                        </div>-->
<!--                    </form>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

<!--    </div>-->
<!--</div>-->
<!--<div class="loadingmodal"></div>-->
<!--    </template>-->
<!--</odoo>-->